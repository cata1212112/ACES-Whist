<html>
<script type="text/javascript">
    function createLobby() {
        nume = document.getElementById("nume_lobby").value
        if (nume.length === 0) {
            console.log("Eroare")
            return
        }
        window.location.replace("/lobby/"+nume)
    }

    window.onload = function () {
        const xhr = new XMLHttpRequest();
        xhr.open("GET", 'http://localhost:5000/getAllLobbies')
        xhr.onload = function () {
            if (xhr.status === 200) {
                var aux = JSON.parse(xhr.response)
                channels = aux["result"]["channels"]
                for (const x in channels) {
                    const lobby = document.createElement("li")
                    const button = document.createElement("button")
                    const textnode = document.createTextNode(x);
                    clients = channels[x]["num_clients"]
                    button.innerHTML = `Join lobby ${clients}/4`
                    button.addEventListener('click', function () {
                        window.location.replace("/lobby/"+x)
                    })
                    if (clients === 4) {
                        continue
                    }
                    lobby.appendChild(textnode);
                    document.getElementById("lobbies").appendChild(lobby)
                    document.getElementById("lobbies").appendChild(button)
                    console.log(channels)
                }
            }
        }
        xhr.send()
    }

</script>

<button onclick="createLobby()">Create Lobby</button>
<input type="text" placeholder="Lobby name" id="nume_lobby">
<div id="lobbies"></div>
</html>